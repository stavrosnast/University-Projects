#include <stdio.h>
#include <openssl/bn.h>
#define NBITS 128

void printBN(char *msg, BIGNUM *a)
{
    /* Use BN_bn2hex(a) for hex string | Use BN_bn2dec(a) for decimal string */
    char *number_str = BN_bn2hex(a);
    printf("%s %s\n", msg, number_str);
    OPENSSL_free(number_str);
}

int main()
{
    BN_CTX *ctx = BN_CTX_new();

    /* Î‘ctivity 6 declaring variables */
    BIGNUM *n = BN_new();
    BIGNUM *e = BN_new();
    BIGNUM *d = BN_new();

    BIGNUM *sign_message = BN_new();
    BIGNUM *message = BN_new();

    BN_hex2bn(&n, "BB021528CCF6A094D30F12EC8D5592C3F882F199A67A4288A75D26AAB52BB9C54CB1AF8E6BF975C8A3D70F4794145535578C9EA8A23919F5823C42A94E6EF53BC32EDB8DC0B05CF35938E7EDCF69F05A0B1BBEC094242587FA3771B313E71CACE19BEFDBE43B45524596A9C153CE34C852EEB5AEED8FDE6070E2A554ABB66D0E97A540346B2BD3BC66EB66347CFA6B8B8F572999F830175DBA726FFB81C5ADD286583D17C7E709BBF12BF786DCC1DA715DD446E3CCAD25C188BC60677566B3F118F7A25CE653FF3A88B647A5FF1318EA9809773F9D53F9CF01E5F5A6701714AF63A4FF99B3939DDC53A706FE48851DA169AE2575BB13CC5203F5ED51A18BDB15");

    // Public Key
    BN_hex2bn(&e, "10001");

    BN_hex2bn(&sign_message, "0fbc7593ab7104355d5739bb329fb74ebc27ddb817870e4550fb7b302a59a7f2af8068db65d692814eba4f55dac0a5c764cf4480f0e013c7e35e9a7853b85d625400a7cae0d397410f7435bb840e016df604c659947a1a3c873b0c32770c026cd7b4cc401306de0584e99e716579916ddacd220151ddef55b09d2a6c246986f034badfddf404efbe74eaf4e4a24032384312c9f4ac03b89ac83ad6f4c725b269ae67263bea16351234d18bef28f554230e486de35fde691849b7d9ae6f6daa8da1304323290d7b919ce18014eab79af3f23602c8b1a6a470b74ba27380bd2837be961d1f572a523201bf6d8aa445ea0bb08abbd111e4cae4da2cc30a41fa946a");

    BN_mod_exp(message, sign_message, e, n, ctx);

    // Print our message
    printBN("message = ", message);

    return 0;
}